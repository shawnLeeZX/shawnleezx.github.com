<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta content="Shawn" property="og:site_name">
  <link href="/favicon.png" rel="icon">

  
  <meta content="Note -- Code Java Under Vim" property="og:title">
  

  
  <meta content="article" property="og:type">
  

  
  <meta content="<h1>World Hacker's Notebook</h1>" property="og:description">
  

  
  <meta content="http://shawnLeeZX.github.io/blog/2013/10/03/note-code-java-under-vim/" property="og:url">
  

  
  <meta content="2013-10-03T10:06:00+08:00" property="article:published_time">
  <meta content="http://shawnLeeZX.github.io/about/" property="article:author">
  

  <meta property="og:image" content="">

  
  
  <meta content="CS" property="article:section">
  
  

  
  
  

  <title>Note -- Code Java Under Vim - Shawn</title>
  <meta name="description" content="IntroductionI am becoming a die-hard vimer…This post will talk about how to establish a powerful Java IDE usingvim.">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/css/main.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <!-- Typesetting math using MathJax -->
  <!-- mathjax config similar to math.stackexchange -->
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$', '$'] ],
       displayMath: [ ['$$', '$$']],
       processEscapes: true,
       skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
     },
     messageStyle: "none",
     "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
   });
  </script>
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44220731-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

  <link href='https://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Fira+Mono' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,200,300,500,600,700,900' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Gentium+Basic:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Alegreya:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Lora:400,400italic,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Fira+Sans:400,300,500,700' rel='stylesheet' type='text/css'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-hQpvDQiCJaD2H465dQfA717v7lu5qHWtDbWNPvaTJ0ID5xnPUlVXnKzq7b8YUkbN" crossorigin="anonymous">
  <link rel="canonical" href="http://shawnLeeZX.github.io/blog/2013/10/03/note-code-java-under-vim/">
  <link rel="alternate" type="application/rss+xml" title="Shawn" href="http://shawnLeeZX.github.io/feed.xml">
</head>

  <body>
    <section>
<nav class="navbar navbar-default navbar-fixed-top">

  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Shawn</a>
    </div>


    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/about">About</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/blog/archives">Archive</a></li>
      </ul>

    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
</section>

    <section>
      <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="jumbotron">
    <div class="container">
      <h1 class="page-title" itemprop="name headline">Note -- Code Java Under Vim</h1>
      <p class="post-meta"><time datetime="2013-10-03T10:06:00+08:00" itemprop="datePublished">Oct 3, 2013</time></p>
    </div>

</div>


  <div class="post-content container" itemprop="articleBody">
    <h2 id="introduction">Introduction</h2>

<p>I am becoming a die-hard vimer…</p>

<p>This post will talk about how to establish a powerful Java IDE using
vim.</p>

<!-- more -->

<h2 id="ant">Ant</h2>

<p>If you want to write java code in pure command line. Ant is the
makefile for java.</p>

<p>Note: Now the <code class="highlighter-rouge">build.xml</code> I wrote will rebuild depends everytime,
which is no efficienty, and I found solutions
<a href="http://stackoverflow.com/questions/2163739/is-there-a-way-to-guarantee-that-an-ant-dependency-is-run-only-once">here</a>,
and
<a href="http://stackoverflow.com/questions/1861569/avoiding-re-building-prerequisites-in-ant">here</a>.
But they are not very satisfactory.</p>

<h3 id="usage">Usage</h3>
<p>Here is a quick start ant tutorial:
<a href="http://ant.apache.org/manual/tutorial-HelloWorldWithAnt.html">Tutorial: Hello World with Apache Ant</a>.</p>

<p>You can find ant download
<a href="http://ant.apache.org/bindownload.cgi">here</a>.</p>

<p>For more information, there is one book called <em>Ant: the Definitive
Guide</em>.</p>

<h4 id="one-note-about-arg-tag">One note about <code class="highlighter-rouge">arg</code> tag</h4>

<p>The documentation of ant sometimes is not very clear, for example:</p>

<p>If one argument takes one parameter, you cannot put them in one <code class="highlighter-rouge">arg</code>
tag. The following code will not work, because ant takes <code class="highlighter-rouge">-docs</code> and
<code class="highlighter-rouge">src</code> as separate argument.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>        <span class="nt">&lt;java</span> <span class="na">jar=</span><span class="s">"${jar.dir}/${ant.project.name}.jar"</span> <span class="na">fork=</span><span class="s">"true"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;arg</span> <span class="na">value=</span><span class="s">"-docs src"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/java&gt;</span>
</code></pre>
</div>

<p>You have to do it this way:</p>

<p>It should be written as following:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>        <span class="nt">&lt;java</span> <span class="na">jar=</span><span class="s">"${jar.dir}/${ant.project.name}.jar"</span> <span class="na">fork=</span><span class="s">"true"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;arg</span> <span class="na">value=</span><span class="s">"-docs"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;arg</span> <span class="na">value=</span><span class="s">"src"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/java&gt;</span>
</code></pre>
</div>

<h3 id="jar-package">Jar Package</h3>

<p>It happens that you need to add external jar libraries in your jar to
make it executable. More details reason about doing this you can read
<a href="http://docs.oracle.com/javase/tutorial/deployment/jar/downman.html">this post</a>.</p>

<p>A long time ago, when I first wrote Java program using Eclipse, just
by clicking generate executable jar file, I could get the executable
jar file, which is very neat – only contains what is needed in my
program.</p>

<p>This time, when I decided to do it the hard way, I actually found it
is not a dummy task. And the way provided below does not do as a good
job as Eclipse, which will put the whole external jar files in the
executable jar file.</p>

<p>This task is accomplished via one-jar. You can download it
<a href="http://one-jar.sourceforge.net/">here</a>.</p>

<p>There are several ways to use the software. But if you want to write
your own ant <code class="highlighter-rouge">build.xml</code>, the most approriate way is to use the <em>Ant
Taskdef</em> way.</p>

<p><a href="http://one-jar.sourceforge.net/index.php?page=getting-started&amp;file=ant">Here</a>
is the official quick start.</p>

<p>However, it is not very instructive…it takes me really some time to
get one-jar work.</p>

<p>So, here is an example:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">"HSearchEngine"</span> <span class="na">basedir=</span><span class="s">"."</span> <span class="na">default=</span><span class="s">"main"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"one-jar.dist.dir"</span> <span class="na">value=</span><span class="s">"/home/hhiker/mine/software/one-jar-ant/"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;import</span> <span class="na">file=</span><span class="s">"${one-jar.dist.dir}/one-jar-ant-task.xml"</span> <span class="na">optional=</span><span class="s">"true"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"src.dir"</span>        <span class="na">value=</span><span class="s">"src"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"build.dir"</span>      <span class="na">value=</span><span class="s">"build"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"classes.dir"</span>    <span class="na">value=</span><span class="s">"${build.dir}/classes"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"jar.dir"</span>        <span class="na">value=</span><span class="s">"${build.dir}/jar"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"jars.dir"</span>        <span class="na">value=</span><span class="s">"./jars"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"main-class"</span>     <span class="na">value=</span><span class="s">"IndexFiles"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;path</span> <span class="na">id=</span><span class="s">"classpath"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">"${jars.dir}"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/path&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">"clean"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;delete</span> <span class="na">dir=</span><span class="s">"${build.dir}"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/target&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">"init"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;mkdir</span> <span class="na">dir=</span><span class="s">"${classes.dir}"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;mkdir</span> <span class="na">dir=</span><span class="s">"${jar.dir}"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/target&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">"compile"</span> <span class="na">depends=</span><span class="s">"init"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;javac</span> <span class="na">srcdir=</span><span class="s">"${src.dir}"</span> <span class="na">destdir=</span><span class="s">"${classes.dir}"</span> <span class="na">classpathref=</span><span class="s">"classpath"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/target&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">"jar"</span> <span class="na">depends=</span><span class="s">"compile"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;one-jar</span> <span class="na">destfile=</span><span class="s">"${jar.dir}/${ant.project.name}.jar"</span> <span class="na">onejarmainclass=</span><span class="s">"${main-class}"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;manifest&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">"Main-Class"</span> <span class="na">value=</span><span class="s">"${main-class}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/manifest&gt;</span>
            <span class="nt">&lt;main&gt;</span>
                <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">"${classes.dir}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/main&gt;</span>
            <span class="nt">&lt;lib&gt;</span>
                <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">"${jars.dir}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/lib&gt;</span>
        <span class="nt">&lt;/one-jar&gt;</span>
    <span class="nt">&lt;/target&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">"run"</span> <span class="na">depends=</span><span class="s">"jar"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;java</span> <span class="na">jar=</span><span class="s">"${jar.dir}/${ant.project.name}.jar"</span> <span class="na">fork=</span><span class="s">"true"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;arg</span> <span class="na">value=</span><span class="s">"-docs"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;arg</span> <span class="na">value=</span><span class="s">"src"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/java&gt;</span>
    <span class="nt">&lt;/target&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">"clean-build"</span> <span class="na">depends=</span><span class="s">"clean, jar"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;target</span> <span class="na">name=</span><span class="s">"main"</span> <span class="na">depends=</span><span class="s">"clean, run"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre>
</div>

<p>The main thing changed because of one-jar is:</p>

<h4 id="add-some-lines">Add Some Lines</h4>

<p>Add the following line in your ant build file.</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"one-jar.dist.dir"</span> <span class="na">value=</span><span class="s">"/home/hhiker/mine/software/one-jar-ant/"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;import</span> <span class="na">file=</span><span class="s">"${one-jar.dist.dir}/one-jar-ant-task.xml"</span> <span class="na">optional=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
</code></pre>
</div>

<p>In one-jar-ant-task.xml, it defines a new task called one-jar, which
is used by user, meaing us.</p>

<p>Note: one-jar-ant-task-${one-jar.version}.jar and files extracted from
it must be in the same directory, which is one-jar.dist.dir above.</p>

<h4 id="one-jar-usage">one-jar Usage</h4>

<p>Basic usage of one-jar is:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>        <span class="nt">&lt;one-jar</span> <span class="na">destfile=</span><span class="s">"${jar.dir}/${ant.project.name}.jar"</span> <span class="na">onejarmainclass=</span><span class="s">"${main-class}"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;manifest&gt;</span>
                <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">"Main-Class"</span> <span class="na">value=</span><span class="s">"${main-class}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/manifest&gt;</span>
            <span class="nt">&lt;main&gt;</span>
                <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">"${classes.dir}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/main&gt;</span>
            <span class="nt">&lt;lib&gt;</span>
                <span class="nt">&lt;fileset</span> <span class="na">dir=</span><span class="s">"${jars.dir}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/lib&gt;</span>
        <span class="nt">&lt;/one-jar&gt;</span>
</code></pre>
</div>

<p>Note:</p>

<ul>
  <li>by experimenting, <code class="highlighter-rouge">lib</code> tag of one-jar can only contain <code class="highlighter-rouge">fileset</code> tag.</li>
  <li>If <code class="highlighter-rouge">manifest</code> is omitted, one-jar will generate one automatically.</li>
</ul>

<p>The outline of one-jar task is showed below(from
<a href="http://one-jar.sourceforge.net/index.php?page=build-tools&amp;file=ant">here</a>).</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>    <span class="nt">&lt;one-jar</span> <span class="na">destfile=</span><span class="s">...</span> <span class="na">manifest=</span><span class="s">...</span><span class="nt">&gt;</span>
        <span class="nt">&lt;manifest&gt;</span>
            Attributes for the manifest of the One-JAR.  Use this instead of
            specifying a "manifest" attribute above
            <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">"attr"</span> <span class="na">value=</span><span class="s">"value"</span><span class="nt">&gt;</span>
            ... etc.
        <span class="nt">&lt;/manifest&gt;</span>
    	<span class="nt">&lt;main</span> <span class="err">[</span><span class="na">jar=</span><span class="s">"main.jar"</span><span class="err">]</span><span class="nt">&gt;</span>
    		<span class="nt">&lt;filesets&gt;</span> which comprise the class-files of the main application.  
    		Do not put JAR files in here; rather use the "jar" attribute if you already have a 
    		pre-canned main program.
    	<span class="nt">&lt;/main&gt;</span>
    	<span class="nt">&lt;lib&gt;</span>
    		<span class="nt">&lt;filesets&gt;</span> containing Jar-files which support the main application.
    	<span class="nt">&lt;/lib&gt;</span>
    	<span class="nt">&lt;binlib&gt;</span>
    		<span class="nt">&lt;filesets&gt;</span> containing native libraries.  Native libraries are expanded into a 
    		temporary directory at runtime: these files are deleted on exit.
    	<span class="nt">&lt;/binlib&gt;</span>
    	<span class="nt">&lt;wrap&gt;</span>
    		<span class="nt">&lt;filesets&gt;</span> containing class-loader wrappers.  These check classloaders 
    		that are loaded from the supporting Jar files to make sure they are compatible 
    		with the One-JAR classloader. This is a complex subject, contact one-jar-support for
    		more information and consulting services if you need to wrap a classloader.
    		You will know you need this if your application does not load classes when
    		you expect it should, from JAR files inside the <span class="nt">&lt;lib&gt;</span> directory.
    	<span class="nt">&lt;/wrap&gt;</span>
    	<span class="nt">&lt;fileset&gt;</span>
    		Any other stuff you want in the top-level One-JAR file.  Remember though, any
    		.class files you put in here will not be able to "see into" JAR files loaded
    		from /main and /lib because their classloader will be the top-level Java 
    		Application Loader, which does not understand One-JAR files (this is how One-JAR 
    		came about in the first place). Contact one-jar support if you find 
    		yourself having problems with this kind of issue.
    	<span class="nt">&lt;/fileset&gt;</span>
    <span class="nt">&lt;/one-jar&gt;</span>
</code></pre>
</div>

<h3 id="auto-complete-tags">Auto complete tags</h3>

<p>To write build.xml quicker, you can use a vim plugin called PairTools – search
it on <a href="www.vim.org">vim.org</a>.</p>

<p>Add the following config for ant type file.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="s2">" File auto-generated by PairTools 1.5.2
"</span> Enable modules
<span class="nb">let </span>g:pairtools_ant_pairclamp <span class="o">=</span> 1
<span class="nb">let </span>g:pairtools_ant_tagwrench <span class="o">=</span> 1
<span class="nb">let </span>g:pairtools_ant_jigsaw <span class="o">=</span> 1
<span class="s2">" Configure PairClamp
let g:pairtools_ant_autoclose = 1
let g:pairtools_ant_forcepairs = 0
let g:pairtools_ant_closepairs = "</span><span class="o">(</span>:<span class="o">)</span>,[:],<span class="o">{</span>:<span class="o">}</span>,<span class="se">\"</span>:<span class="se">\"</span><span class="s2">"
let g:pairtools_ant_smartclose = 1
let g:pairtools_ant_smartcloserules = '</span><span class="se">\w</span><span class="s2">'
let g:pairtools_ant_apostrophe = 0
let g:pairtools_ant_antimagic = 1
let g:pairtools_ant_antimagicfield = "</span>Comment,String<span class="s2">"
let g:pairtools_ant_pcexpander = 0
let g:pairtools_ant_pceraser = 1
"</span> Configure TagWrench
<span class="nb">let </span>g:pairtools_ant_tagwrenchhook <span class="o">=</span> <span class="s1">'tagwrench#BuiltinBasicTagHook'</span>
<span class="nb">let </span>g:pairtools_ant_twexpander <span class="o">=</span> 1
<span class="nb">let </span>g:pairtools_ant_tweraser <span class="o">=</span> 1
</code></pre>
</div>

<p>One thing needs attention is this line:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nb">let </span>g:pairtools_ant_tagwrenchhook <span class="o">=</span> <span class="s1">'tagwrench#BuiltinBasicTagHook'</span>
</code></pre>
</div>
<p>This line tells PairTools to use BuiltinBasicTagHook for ant tags.</p>

<p>BuiltinBasicTagHook is a basic tag builder that automatically add an
ending tag when the starting tag does not end with /&gt;, i.e. it ends
with a single &gt;. Also, tags starting with a bang (!) or slash (/)
never generate closing tags.</p>

<h3 id="syntax-highlighting">Syntax highlighting</h3>
<p>I do not write xml code frequently, thus I add the following line to
make all xml files to be viewed as ant files.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>au BufNewFile,BufRead <span class="k">*</span>.xml <span class="nb">set </span><span class="nv">filetype</span><span class="o">=</span>ant
</code></pre>
</div>

<p>I have tried the following code, but it does not work. Guess it is overrided.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>au BufNewFile,BufRead <span class="k">*</span>.xml setf ant
</code></pre>
</div>
<h2 id="eclim">Eclim</h2>

<h3 id="compile">Compile</h3>

<p>Eclim provides the following command to let you call the build.xml written:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>:Ant <span class="o">[</span>&lt;target&gt; ...]
</code></pre>
</div>

<p>which performs the following steps:</p>

<ol>
  <li>Saves any previous ‘makeprg’ and ‘errorformat’ option settings so
that you can define your own settings for the :make command.</li>
  <li>Sets ‘makeprg’ to execute ant with the -find option so that it will
search for your build.xml file in the current directory or in a
parent directory.</li>
  <li>Sets ‘errorformat’ to recognize the following errors:
    <ol>
      <li>javac errors.</li>
      <li>javadoc errors.</li>
      <li>jasper jsp compilattion errors.</li>
      <li>junit errors / failures.</li>
      <li>cactus errors / failures.</li>
    </ol>
  </li>
  <li>Executes :make.</li>
  <li>Restores your previous ‘makeprg’ and ‘errorformat’ option settings.</li>
</ol>

<h3 id="auto-completion--import">auto-completion &amp; import</h3>

<p>It is really a painful journey to find a standalone java code completion plugin,
which failed. The eclim is the final solution. So is automatically adding import
statement.</p>

<h2 id="tags--jump">tags &amp; jump</h2>

<p>Use ctags to jump around the code. This statement will generate tags for Java.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>ctags -R --language-force<span class="o">=</span>java
</code></pre>
</div>

<p>Added the tag generated in your java config file:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nb">set </span>tags+<span class="o">=</span>JAVA_TAG
</code></pre>
</div>

<p>Then everytime you write a java program, those tag will work.</p>

<p>This command will show language ctags supports.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>ctags --list-kinds<span class="o">=</span>java
</code></pre>
</div>

<p>I still have one question here:</p>

<p>what does pri field mean when using ctags? such as FS.</p>

<h2 id="lookup-javadoc-in-vim">Lookup javadoc in vim.</h2>

<p>You can generate txt doc for Java SDK with vim helptags. The method is here:
<a href="http://vimdoclet.sourceforge.net/">vimdoclet</a>.</p>

<p>Note:</p>

<ul>
  <li>duplicate names must add package to distinguish them.</li>
  <li>create a lib directory after extracting vimdoclet-VERSION.tgz,
otherwise it won’t work.</li>
</ul>

<p>This will generate txt format doc in ./tmp folder. Put docs generated
in ~/.vim/doc or if you are using vim plugin manager, take pathegon as
an example, create a folder named java_doc under bundle, make a folder
named doc, then put doc generated under this folder, which is more
manageable.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>ant -f run.xml run -Dvimdoclet.source.root<span class="o">=</span>/home/hhiker/mine/software/jdk1.7.0_40/share/ -Dvimdoclet.outputDir tmp
</code></pre>
</div>

<p>Generate helptags:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>:helptags ~/.vim/bundle/java_doc/doc
</code></pre>
</div>

<p>Note: Although eclim provides javadoc preview feature as well, after
some usage, I found this one better.</p>

<p>TODO: I do not know how to generate help files for source files other than JDK’s now.</p>

<h2 id="syntax-checking-on-the-fly">Syntax checking on the fly</h2>

<p>Ok, this is a bonus. Just minutes ago, I found my syntax checking
plugin for vim mysteriously gone(explanation later). I have to readd
it.</p>

<p><a href="https://github.com/scrooloose/syntastic">Syntastic</a> provides syntax
checking on the fly(by default it is the time when you save files)</p>

<p>Add the following lines to make Syntastic more useful:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="s2">" For ~/.vim/bundle/syntastic/
"</span> <span class="o">======================================================</span>
<span class="nb">set </span>statusline+<span class="o">=</span>%#warningmsg#
<span class="nb">set </span>statusline+<span class="o">=</span>%<span class="o">{</span>SyntasticStatuslineFlag<span class="o">()}</span>
<span class="nb">set </span>statusline+<span class="o">=</span>%<span class="k">*</span>
<span class="s2">" ======================================================
</span></code></pre>
</div>

<p>Type :Errors in vim to get a location list of errors.</p>

<h3 id="why-plugins-mysteriously-disappear">Why plugins mysteriously disappear?</h3>
<p>At the first time I added them, I used git clone, which would leave a
git repo in the folder, however, when this happens, the main repo will
not take files under those folder into consideration.</p>

<p>At the time I cloned my plugins on my new laptop, they were just empty
folders…</p>

<p>The proper way to avoid this is to remove the git repo of plugins. But what if this
already happened? Remove and readd them.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>git rm --cached -rf PLUGIN_FOLDER_NAME
git add PLUGIN_FOLDER_NAME
</code></pre>
</div>

<h2 id="conclusion">Conclusion</h2>

<p>It took me days to get this done. Hope it helps.</p>

  </div>

</article>

    </section>

    
    <div class="container">
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread" aria-live="polite"><script type="text/javascript">
      var disqus_shortname = 'nautilus-shell-of-hhiker';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://shawnLeeZX.github.io/blog/2013/10/03/note-code-java-under-vim/';
        var disqus_url = 'http://shawnLeeZX.github.io/blog/2013/10/03/note-code-java-under-vim/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
      </section>
    </div>
    

    <!-- <nav class="navbar navbar-default navbar-fixed-bottom"> -->
<!-- <div class="container footer-content"> -->
    <!-- Nothing is there. -->
<!-- </div> -->
<!-- </nav> -->
  </body>

</html>
